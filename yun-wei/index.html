<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : Brown Stone  
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20100928

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Hir0C blog - 运维</title>
<link href="../theme/css/style.css" rel="stylesheet" type="text/css" media="screen" />
<link href="../" type="application/atom+xml" rel="alternate" title="Hir0C blog ATOM Feed" />
</head>
<body>
<div id="wrapper">
	<div id="page">
		<div id="page-bgtop">
			<div id="page-bgbtm">
 
        
				<div id="content">
					<div class="post">
						<h2 class="title"><a href="../yun-wei/2016-03-22-18-34.html">wordpress on nginx 搭建</a></h2>
						<p class="meta"><span class="date">Le  </span><span class="posted">Par <a href="#">Hir0C</a></span><span>&nbsp; | Catégorie : <a href="../yun-wei/index.html">运维</a></span></p>
					<p class="meta">Tags : <span><a href="../tag/nginx.html">nginx</a> / </span>
<span><a href="../tag/wordpress.html">wordpress</a> / </span>
</p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p><em>内网搞了了bolg，采用了nginx+php+mysql+wordpress。整个过程并不复杂，记录下遇到的问题。</em></p>
<h3>1. 安装nginx</h3>
<div class="highlight"><pre><span></span>    ./configure --prefix=/usr/local/nginx --with-zlib --with-pcre=/opt/ftp/http-server/pcre-8.34 --with-http_perl_module --with-http_stub_status_module --with-http_image_filter_module --with-http_gunzip_module --with-http_gzip_static_module
</pre></div>


<h3>2. php</h3>
<div class="highlight"><pre><span></span>    ./configure --prefix=/usr/local/php &#39;--with-config-file-path=/usr/local/php-5.4.23/etc&#39; &#39;--enable-fpm&#39; &#39;--enable-pcntl&#39; &#39;--enable-shmop&#39; &#39;--enable-sysvsem&#39; &#39;--enable-inline-optimization&#39; &#39;--disable-rpath&#39; &#39;--enable-safe-mode&#39; &#39;--with-mysql=mysqlnd&#39; &#39;--with-mysqli=mysqlnd&#39; &#39;--with-pdo-mysql=mysqlnd&#39; &#39;--with-libxml-dir=/usr/local&#39; &#39;--enable-xml=/usr/local&#39; &#39;--with-openssl&#39; --with-zlib &#39;--enable-bcmath&#39; &#39;--with-bz2&#39; &#39;--enable-zip&#39; &#39;--enable-exif&#39; &#39;--with-gd&#39; &#39;--enable-gd-native-ttf&#39; &#39;--with-freetype-dir=/usr/local&#39; &#39;--with-jpeg-dir=/usr/local&#39; &#39;--with-png-dir&#39; &#39;--with-mhash&#39; &#39;--with-mcrypt=/usr/local&#39; &#39;--enable-mbstring&#39; &#39;--enable-mbregex&#39; &#39;--with-iconv-dir=/usr/local&#39; &#39;--with-curl&#39; &#39;--with-curlwrappers&#39; &#39;--enable-ftp&#39; &#39;--enable-sockets&#39;
</pre></div>


<h3>3. mysql</h3>
<div class="highlight"><pre><span></span>    cmake -DCMAKE_INSTALL_PREFIX=/opt/mysql/ -DSYSCONFDIR=/etc/my.cnf -DMYSQL_UNIX_ADDR=/opt/mysql/tmp/mysqld.sock -DMYSQL_USER=mysql -DDEFAULT_CHARSET=all -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_ZLIB=/usr/local/lib/ -DWITH_READLINE=1 -DWITH_DATADIR=/opt/mysql/data/ -DWITH_SSL=bundled -DENABLED_LOCAL_INFILE=1-DWITH_READLINE=1 -DWITH_DEBUG=0

    make &amp;&amp; make install
</pre></div>


<h3>4. wordpress安装</h3>
<p>略</p>
<h3>5. 配置</h3>
<p>这次遇到麻烦的地方主要有三点:</p>
<ul>
<li>
<p>mysql初始化</p>
<div class="highlight"><pre><span></span>scripts/mysql_install_db --user mysql --basedir= --datadir=
</pre></div>


</li>
<li>
<p>mysql设置密码需要先执行</p>
<div class="highlight"><pre><span></span>set old_passwords = 0;
</pre></div>


</li>
<li>
<p>nginx重写规则</p>
<div class="highlight"><pre><span></span><span class="x">if (-f </span><span class="p">$</span><span class="nv">request_filename</span><span class="x">/index.html)</span><span class="err">{</span><span class="x"></span>
<span class="x">    rewrite (.*) </span><span class="p">$</span><span class="x">1/index.html break;</span>
<span class="x">}</span>
<span class="x">if (-f </span><span class="p">$</span><span class="nv">request_filename</span><span class="x">/index.php)</span><span class="err">{</span><span class="x"></span>
<span class="x">    rewrite (.*) </span><span class="p">$</span><span class="x">1/index.php;</span>
<span class="x">}</span>
<span class="x">if (!-f </span><span class="p">$</span><span class="nv">request_filename</span><span class="x">)</span><span class="err">{</span><span class="x"></span>
<span class="x">    rewrite (.*) /index.php;</span>
<span class="x">}</span>
</pre></div>


</li>
</ul>
<p>这样访问目录时就会自动访问下面的index.php了。</p>	
						</div>
					</div>
	
			                <div class="post">
			                        <h2 class="title">Autres articles</h2>
			                </div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="../yun-wei/2016-03-22-18-26.html">sublime插件安装</a></h2>
						<p class="meta"><span class="date">Le 二 22 三月 2016</span><span class="posted">Par <a href="#">Hir0C</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p><em>使用Package Control组件，在sublime3下安装插件，按照网上方法会出现urllib2模块找不到的报错，但是之前并没出现过错误，查看了下之前是使用的urllib，在此记录下。</em></p>
<h2>简单说下导入步骤：</h2>
<h3>1. `ctrl + ``键，呼出命令行，键入命令:</h3>
<div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">urllib.request</span><span class="o">,</span><span class="nn">os</span><span class="p">;</span> <span class="n">pf</span> <span class="o">=</span> <span class="s1">&#39;Package Control.sublime-package&#39;</span><span class="p">;</span> <span class="n">ipp</span> <span class="o">=</span> <span class="n">sublime</span><span class="o">.</span><span class="n">installed_packages_path</span><span class="p">();</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ProxyHandler</span><span class="p">())</span> <span class="p">);</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ipp</span><span class="p">,</span> <span class="n">pf</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span> <span class="s1">&#39;http://sublime.wbond.net/&#39;</span> <span class="o">+</span> <span class="n">pf</span><span class="o">.</span><span class="n">replace ...</span></pre></div>	
						 <a class="readmore" href="../yun-wei/2016-03-22-18-26.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="../yun-wei/2016-03-22-18-15.html">VIM插件安装</a></h2>
						<p class="meta"><span class="date">Le 二 22 三月 2016</span><span class="posted">Par <a href="#">Hir0C</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <h2>vim ide 基本配置</h2>
<h3>一、安装VIM</h3>
<p>只是记录下vim的编译选项</p>
<blockquote>
<p>--with-features=huge 一定要加</p>
</blockquote>
<div class="highlight"><pre><span></span>    ./configure --prefix=/usr/local/vim74 \
     **--with-features=huge** \
     --enable-pythoninterp --enable-perlinterp \
     --enable-rubyinterp --enable-luainterp \
     --enable-multibyte --enable-sniff --enable-fontset \
     --disable-selinux --enable-cscope
</pre></div>


<h3>二、插件安装</h3>
<ul>
<li><a href="http://www.vim.org/scripts/script.php?script_id=1213">VJDE</a><div class="highlight"><pre><span></span>tar -xzf vjde.tgz -C /usr/share/vim/vimfiles 
chmod +x /usr/share/vim/vimfiles/plugin/vjde/readtags
</pre></div>


</li>
</ul>
<p>使用官网的方法就可以，自己编译安装的vim就解压到 <code>/usr/local ...</code></p>	
						 <a class="readmore" href="../yun-wei/2016-03-22-18-15.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="../yun-wei/2016-03-22-18-09.html">storm 基本安装</a></h2>
						<p class="meta"><span class="date">Le 二 22 三月 2016</span><span class="posted">Par <a href="#">Hir0C</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <h3>storm安装步骤:</h3>
<h4>一、安装zookeeper</h4>
<ol>
<li>
<p>全部选用CDH的产品，不用担心版本问题，省心。
包都在这里:http://archive.cloudera.com/cdh4/cdh/4/</p>
</li>
<li>
<p>配置zookeeper
解压稍微修改配置就可以使用，只需要定义dataDir和server.1/2/3</p>
<div class="highlight"><pre><span></span>dataDir=/data/zookeeper/tmp
hostname1:2888:3888
hostname2:2888:3888
hostname3:2888:3888
</pre></div>


</li>
<li>
<p>启动
        ./zkServer.sh start</p>
</li>
</ol>
<h4>二、安装消息队列ZeroMQ</h4>
<ol>
<li>直接上最新版本zeromq-4.0.3</li>
</ol>
<p>http://download.zeromq.org/zeromq-4.0.3.tar ...</p>	
						 <a class="readmore" href="../yun-wei/2016-03-22-18-09.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="../yun-wei/2016-03-22-16-56.html">Zsh安装配置</a></h2>
						<p class="meta"><span class="date">Le 二 22 三月 2016</span><span class="posted">Par <a href="#">Hir0C</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <h2>zsh是个好东西，关键是能装逼</h2>
<h3>一、安装zsh</h3>
<p>略</p>
<h4>二、切换用户使用shell</h4>
<div class="highlight"><pre><span></span>    usermod -s /usr/local/bin/zsh root
</pre></div>


<p>或者</p>
<div class="highlight"><pre><span></span>    chsh -s /bin/zsh
</pre></div>


<h4>三、git安装</h4>
<p>没啥好说的，官网步骤都有</p>
<div class="highlight"><pre><span></span>    yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel -y
    make prefix=/usr/local all
    make prefix=/usr/local install
</pre></div>


<h4>四、安装python2.7.x</h4>
<p>老三步</p>
<div class="highlight"><pre><span></span>    ./configure --prefix=/usr/local ...</pre></div>	
						 <a class="readmore" href="../yun-wei/2016-03-22-16-56.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="../yun-wei/2016-03-22-16-12.html">vsftpd 虚拟用户配置</a></h2>
						<p class="meta"><span class="date">Le 二 22 三月 2016</span><span class="posted">Par <a href="#">Hir0C</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <h3>简介</h3>
<p>ftp 虚拟用户配置</p>
<h3>配置</h3>
<ol>
<li>
<p>创建nologin用户</p>
<div class="highlight"><pre><span></span>useradd -s /sbin/nologin -d /opt/ftp vftp
</pre></div>


</li>
<li>
<p>创建虚拟用户密码</p>
<div class="highlight"><pre><span></span>db_load -T -t hash -f vftpusers.txt /mnt/vftpusers.db
</pre></div>


</li>
<li>
<p>添加pam认证
/etc/pam.d/vsftpd起始两行添加：</p>
<div class="highlight"><pre><span></span>auth sufficient /lib64/security/pam_userdb.so db=vftpusers
account sufficient /lib64/security/pam_userdb.so db=vftpusers
</pre></div>


</li>
<li>
<p>修改ftp配置(使用主动模式)</p>
<div class="highlight"><pre><span></span>port_enable=YES
write_enable ...</pre></div></li></ol>	
						 <a class="readmore" href="../yun-wei/2016-03-22-16-12.html">Lire la suite …</a>
						</div>
					</div>
					<div style="clear: both;">&nbsp;</div>
				</div>
				<div id="sidebar">
					<div id="logo">
						<h1><a href="..">Hir0C blog</a></h1>
					</div>
					<div id="menu">
						<ul>
							<li ><a href="..">Home</a></li>
							<li ><a href="../archives.html">Archives</a></li>
						</ul>
					</div>
					<ul>
						<li>
							<h2>Catégories</h2>
							<ul>
								 <li class="active"><a href="../yun-wei/index.html">运维</a></li>
							</ul>
						</li>
						<li>
						        <h2>Tags</h2>
						        <ul>
                                                                <li><a href="../tag/bian-ji-qi.html">编辑器</a></li>
                                                                <li><a href="../tag/vsftpd.html">vsftpd</a></li>
                                                                <li><a href="../tag/nginx.html">nginx</a></li>
                                                                <li><a href="../tag/wordpress.html">wordpress</a></li>
                                                                <li><a href="../tag/yun-wei.html">运维</a></li>
                                                                <li><a href="../tag/storm.html">storm</a></li>
                                                                <li><a href="../tag/bash.html">bash</a></li>
						        </ul>
						</li>
						
						
					</ul>
				</div>
				<!-- end #sidebar -->
				<div style="clear: both;">&nbsp;</div>
			</div>
		</div>
	</div>
	<!-- end #page -->

<div id="footer">
	<p>Copyright (c) 2008 Sitename.com. All rights reserved. Design by <a href="http://www.freecsstemplates.org/">CSS Templates</a>.</p>
	<p>Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>, which takes great advantages of <a href="http://python.org">python</a>.
</p>
</div>
<!-- end #footer -->
</body>
</html>